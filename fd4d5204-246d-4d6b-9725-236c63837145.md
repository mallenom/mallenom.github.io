# Интеграция с Delphi при помощи COM-технологии

Пример интеграции расположен в каталоге _%ProgramData%\Mallenom\Automarshal.SDK\Samples\recar2.sample.delphi_.


Данный пример работает только с **Ядром распознавания** разрядностью x86.


Для интеграции **Ядра распознавания** в ПО, создаваемое в среде разработки Delphi (XE4) необходимо выполнить следующие шаги:
&nbsp;<ul><li>
Установить требуемые <a href="Prerequisites">Пререквизиты</a>.</li><li>
Зарегистрировать компонент **Ядра распознавания** как описано в [91c5f10f-1ac8-457c-ac1d-c27ba5ba5296].</li><li>
Создать новый проект или открыть уже существующий.</li><li>
Из меню среды разработки отрыть диалоговое окно **Component/Import component...**.</li><li>
Выбрать в окне пункт **Import a Type Library**.

<br /><artLink target="delphi.com_01" /><br />
Нажать кнопку **Next**.</li><li>
В списке зарегистрированных компонентов выбрать **Recar2.Core**.

<br /><artLink target="delphi.com_02" /><br />
Если такого компонента нет, то нажать кнопку **Add**. В окне **Register OLE Control** выбрать файл _%ProgramFiles(x86)%\Recar2\binaries\recar2.com.tlb_:

<br /><artLink target="delphi.com_03" /><br />
Нажать кнопку **Next**.</li><li>
Установить галочку **Generate Component Wrappers**:

<br /><artLink target="delphi.com_04" /><br />
Нажать кнопку **Next**.</li><li>
Выбрать пункт **Create Unit**:

<br /><artLink target="delphi.com_05" /><br />
Нажать кнопку **Finish**.


После чего будет создан файл _recar2_TLB_.</li><li>
Открыть файл _recar2_TLB_, и найти в нем описание процедуры `NumberRecognized`.

<br /><artLink target="delphi.com_06" /><br />
Скопировать значение `dispid` (выделено на рисунке).</li><li>
Найти в файле _recar2_TLB_ описание процедуры `TVideoCoreCom.InvokeEvent`. Раскомментировать тело процедуры и вставить вместо -1 значения скопированного dispid:

<br /><artLink target="delphi.com_07" /><br /></li><li>
Подключить модуль _recar2_TLB_ в раздел _uses_ того модуля, где будет использоваться ядро распознавания.


Создать объект типа `TVideoCoreCom`. Использование описано в примере.</li></ul>&nbsp;

# Интеграция с 1C

Пример интеграции расположен в каталоге _%ProgramData%\Mallenom\Automarshal.SDK\Samples\recar2.sample.1c_.


Перед запуском примера необходимо установить <a href="Prerequisites">Пререквизиты</a> и зарегистрировать компонент **Ядра распознавания** как описано в [91c5f10f-1ac8-457c-ac1d-c27ba5ba5296].



## Пример использования Ядра распознавания в 1С 8.x Предприятие.

Взаимодействие из 1С осуществляется посредством технологии COM, поэтому сначала необходимо установить требуемые пререквизиты <a href="Prerequisites">Пререквизиты</a> и зарегистрировать компонент **Ядра распознавания** как описано в [91c5f10f-1ac8-457c-ac1d-c27ba5ba5296].


Для запуска примера нужно добавить внешнюю обработку recar2_example.epf из поставки SDK в конфигурацию 1С.

<br /><artLink target="1s" /><br />
При запуске примера нужно нажать кнопку Настроить и настроить видеоканалы на захват видео. При закрытии формы настройки автоматически сохранятся в папке "ProgramData\Mallenom\Recar2.Core\configs".


В модуле формы определена переменная Core, которая будет содержать ссылку на COM-объект – ядро системы распознавания:


```
&НаКлиенте
Перем Core Экспорт;
```

Для создания COM-объекта ядра распознавания при открытии формы определена процедура:


```
&НаКлиенте
Процедура ПриОткрытии(Отказ)
  Core = Новый COMобъект("Recar2.Com.VideoCoreCom");
  // Подписка на событие распознавания ГРЗ
  ДобавитьОбработчик Core.NumberRecognized, Recognized;
  // Задание числа каналов видео
  Core.VideoProcessChannelCount = 2;
  // Инициализация
  Core.Initialize();
  // Загрузка настроек
  Core.LoadSettings();
  // Запуск
  Core.Start();
КонецПроцедуры
```

Для обработки события распознавания номера транспортного средства определена процедура:


```
&НаКлиенте
Процедура Recognized(Data)
  Сообщить("Распознан номер: " + Data.Number);
КонецПроцедуры
```

Открытие окна настройки параметров системы распознавания выполняется в следующей процедуре:


```
&НаКлиенте
Процедура Настройка(Команда)
  Сообщить("Настройка");
  Core.ShowSetupForm();
  // Перезапуск с новыми настройками
  Core.Stop();
  Core.Start();
КонецПроцедуры
```

Для сохранения настроек системы распознавания при закрытии окна определена процедура:


```
&НаКлиенте
Процедура ПриЗакрытии()
  Core.Stop();
  // Сохранение настроек
  Core.SaveSettings();
  Core.Dispose();
  Core = null;
КонецПроцедуры
```

